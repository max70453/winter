products = 
[ 
    { id: 1, img: 'top-4.png', category: 'Мороженое', name: 'Крем брюле', price: 109, description: 'молоко обезжиренное сухое, молочный белок, сахар, масло кокосовое, «Сироп карамель» (инвертный сахарный сироп, глюкозный сироп, вода, карамелизированный сахар, сухое обезжиренное молоко, молоко сухое цельное, масло сливочное, кокосовое масло, эмульгатор лецитин соевый, регуляторы кислотности: карбонат кальция, гидроксид натрия), какао-порошок, вода, стабилизатор', top: false, inStock: true, recomended: false, sale: false, new: false },
    { id: 2, img: 'top-1.webp', category: 'Мороженое', name: 'Пломбир', price: 165, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 3, img: 'top-5.jpg', category: 'Мороженое', name: 'Дынька медовая', price: 200, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 4, img: 'top-2.jpg', category: 'Мороженое', name: 'Пломбир шоколадный', price: 120, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 5, img: 'top-3.jpg', category: 'Мороженое', name: 'Ванильное', price: 180, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 6, img: 'tab-1.png', category: 'Мороженое', name: 'Пломбир Ялтинский', price: 250, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 7, img: 'tab-2.png', category: 'Мороженое', name: 'Пломюир Ялтиский шоколадный', price: 140, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 8, img: 'tab-4.png', category: 'Мороженое', name: 'Пломбир Симферопольский', price: 170, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 9, img: 'tab-6.png', category: 'Мороженое', name: 'Пломбир 100%', price: 200, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 10, img: 'tab-7.png', category: 'Мороженое', name: 'Пломбир ванильный', price: 150, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 11, img: 'tab-8.png', category: 'Мороженое', name: 'Мохито', price: 120, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 12, img: 'banner-1.webp',category: 'Мороженое',  name: 'Земляничное', price: 320, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 13, img: 'banner-2.png', category: 'Мороженое', name: 'Семейное', price: 160, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 14, img: 'lp-1.jpg', category: 'Мороженое', name: 'С клубничным джемом', price: 210, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 15, img: 'lp-2.jpg', category: 'Мороженое', name: 'Пломбир арахисовый', price: 150, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 16, img: 'lp-3.jpg',category: 'Мороженое',  name: 'Молочное', price: 190, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 17, img: 'lp-4.jpg', category: 'Мороженое', name: 'Клубничное', price: 140, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 18, img: 'lp-5.jpg', category: 'Мороженое', name: 'Фисташковое', price: 190, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 19, img: 'lp-6.jpg', category: 'Мороженое', name: 'Шоколадная крошка', price: 100, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 20, img: 'product-1.jpg', category: 'Полуфабрикаты', name: 'Суп гороховый', price: 350, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 21, img: 'product-2.jpg', category: 'Полуфабрикаты', name: 'Горошек «Долина желаний»', price: 130, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 22, img: 'product-3.jpg', category: 'Полуфабрикаты', name: 'Вареники «Водолей»', price: 130, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 23, img: 'product-4.jpg',category: 'Полуфабрикаты',  name: 'Харчо «Суперсуп»', price: 100, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 24, img: 'product-5.jpg', category: 'Полуфабрикаты', name: 'Суп гороховый с беконом «Суперсуп»', price: 130, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 25, img: 'product-6.jpg', category: 'Рыба и морепродукты', name: 'Икра Трески', price: 180, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 26, img: 'product-7.jpg',category: 'Рыба и морепродукты',  name: 'Филе рыбное', price: 200, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 27, img: 'product-8.jpg', category: 'Рыба и морепродукты', name: '«Икорка»', price: 230, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 28, img: 'product-9.jpg', category: 'Молочные продукты', name: 'Сир «Тульчинка»', price: 330, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 29, img: 'product-10.jpg',category: 'Молочные продукты',  name: '«Ферма» Сыр', price: 190, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 30, img: 'product-11.jpg',category: 'Молочные продукты',  name: 'Сыр кисломолочный', price: 320, description: '', top: false, recomended: false, sale: false, new: false },
    { id: 31, img: 'product-12.jpg',category: 'Молочные продукты',  name: 'Сыр', price: 80, description: '', top: false, recomended: false, sale: false, new: false },
];

'use strict';

(function ($) {

    /*------------------
        Preloader
    --------------------*/
    $(window).on('load', function () {
        $(".loader").fadeOut();
        $("#preloder").delay(200).fadeOut("slow");

        /*------------------
            Gallery filter
        --------------------*/
        $('.featured__controls li').on('click', function () {
            $('.featured__controls li').removeClass('active');
            $(this).addClass('active');
        });
        if ($('.featured__filter').length > 0) {
            var containerEl = document.querySelector('.featured__filter');
            var mixer = mixitup(containerEl);
            
            // Обновление счетчика найденных товаров после фильтрации
            mixer.on('mixEnd', function(state) {
                // Подсчитываем количество отображаемых элементов
                const visibleCount = state.matching.length;
                
                // Находим элемент для отображения количества товаров
                const foundCountElement = document.querySelector('.filter__found span');
                if (foundCountElement) {
                    // Обновляем количество найденных товаров
                    foundCountElement.textContent = visibleCount;
                }
                
                // Обновляем классы для элементов
                $('.featured__filter .mix').each(function() {
                    if ($(this).css('display') === 'none') {
                        $(this).addClass('hidden-item');
                    } else {
                        $(this).removeClass('hidden-item');
                    }
                });
            });
            
            // Обновляем счетчик товаров при инициализации
            const initialCount = $('.featured__filter .mix:visible').length;
            const foundCountElement = document.querySelector('.filter__found span');
            if (foundCountElement) {
                foundCountElement.textContent = initialCount;
            }
        }
    });

    /*------------------
        Background Set
    --------------------*/
    $('.set-bg').each(function () {
        var bg = $(this).data('setbg');
        $(this).css('background-image', 'url(' + bg + ')');
    });

    //Humberger Menu
    $(".humberger__open").on('click', function () {
        $(".humberger__menu__wrapper").addClass("show__humberger__menu__wrapper");
        $(".humberger__menu__overlay").addClass("active");
        $("body").addClass("over_hid");
    });

    $(".humberger__menu__overlay").on('click', function () {
        $(".humberger__menu__wrapper").removeClass("show__humberger__menu__wrapper");
        $(".humberger__menu__overlay").removeClass("active");
        $("body").removeClass("over_hid");
    });

    /*------------------
		Navigation
	--------------------*/
    $(".mobile-menu").slicknav({
        prependTo: '#mobile-menu-wrap',
        allowParentLinks: true
    });

    /*-----------------------
        Categories Slider
    ------------------------*/
    $(".categories__slider").owlCarousel({
        loop: true,
        margin: 0,
        items: 4,
        dots: false,
        nav: true,
        navText: ["<span class='fa fa-angle-left'><span/>", "<span class='fa fa-angle-right'><span/>"],
        animateOut: 'fadeOut',
        animateIn: 'fadeIn',
        smartSpeed: 1200,
        autoHeight: false,
        autoplay: true,
        responsive: {

            0: {
                items: 1,
            },

            480: {
                items: 2,
            },

            768: {
                items: 3,
            },

            992: {
                items: 4,
            }
        }
    });


    $('.hero__categories__all').on('click', function(){
        $('.hero__categories ul').slideToggle(400);
    });

    /*--------------------------
        Latest Product Slider
    ----------------------------*/
    $(".latest-product__slider").owlCarousel({
        loop: true,
        margin: 0,
        items: 1,
        dots: false,
        nav: true,
        navText: ["<span class='fa fa-angle-left'><span/>", "<span class='fa fa-angle-right'><span/>"],
        smartSpeed: 1200,
        autoHeight: false,
        autoplay: true
    });

    /*-----------------------------
        Product Discount Slider
    -------------------------------*/
    $(".product__discount__slider").owlCarousel({
        loop: true,
        margin: 0,
        items: 3,
        dots: true,
        smartSpeed: 1200,
        autoHeight: false,
        autoplay: true,
        responsive: {

            320: {
                items: 1,
            },

            480: {
                items: 2,
            },

            768: {
                items: 2,
            },

            992: {
                items: 3,
            }
        }
    });

    /*---------------------------------
        Product Details Pic Slider
    ----------------------------------*/
    $(".product__details__pic__slider").owlCarousel({
        loop: true,
        margin: 20,
        items: 4,
        dots: true,
        smartSpeed: 1200,
        autoHeight: false,
        autoplay: true
    });

    /*-----------------------
		Price Range Slider
	------------------------ */
    var rangeSlider = $(".price-range"),
        minamount = $("#minamount"),
        maxamount = $("#maxamount"),
        minPrice = rangeSlider.data('min'),
        maxPrice = rangeSlider.data('max');
    rangeSlider.slider({
        range: true,
        min: minPrice,
        max: maxPrice,
        values: [minPrice, maxPrice],
        slide: function (event, ui) {
            minamount.val(ui.values[0] + ' р');
            maxamount.val(ui.values[1] + ' р');
        }
    });
    minamount.val(rangeSlider.slider("values", 0) + ' р');
    maxamount.val(rangeSlider.slider("values", 1) + ' р');

    /*--------------------------
        Select
    ----------------------------*/
    $("select").niceSelect();

    /*------------------
		Single Product
	--------------------*/
    $('.product__details__pic__slider img').on('click', function () {

        var imgurl = $(this).data('imgbigurl');
        var bigImg = $('.product__details__pic__item--large').attr('src');
        if (imgurl != bigImg) {
            $('.product__details__pic__item--large').attr({
                src: imgurl
            });
        }
    });

    /*-------------------
		Quantity change
	--------------------- */
    var proQty = $('.pro-qty');
    proQty.prepend('<span class="dec qtybtn">-</span>');
    proQty.append('<span class="inc qtybtn">+</span>');
    proQty.on('click', '.qtybtn', function () {
        var $button = $(this);
        var oldValue = $button.parent().find('input').val();
        if ($button.hasClass('inc')) {
            var newVal = parseFloat(oldValue) + 1;
        } else {
            // Don't allow decrementing below zero
            if (oldValue > 0) {
                var newVal = parseFloat(oldValue) - 1;
            } else {
                newVal = 0;
            }
        }
        $button.parent().find('input').val(newVal);
    });

})(jQuery);